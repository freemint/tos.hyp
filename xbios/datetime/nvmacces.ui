!iflang [english]


!begin_node NVMaccess
(!begin_liste) [Availability]

!item [Name:]
¯NVMacess® - Konfiguration des "non volatile memory" der Echtzeituhr.

!item [Opcode:]
46

!item [Syntax:]
(!link [Bindings fr NVMaccess] [Bindings fr NVMaccess])

!item [Description:]
Die XBIOS-Routine NVMaccess erm”glicht die Konfiguration des NVM der
Echtzeituhr. Diese verfgt ber 50 Bytes nicht-flchtiges RAM, wobei die
letzten zwei Bytes als Prfsumme verwendet werden. Es gilt:
!begin_table [l|l]
Parameter !! Bedeutung
!hline
op !! 0 = NVM auslesen und Prfsumme checken
~  !! 1 = NVM beschreiben, Prfsumme checken
~  !! ~~~~und neu setzen
~  !! ~
~  !! 2 = NVM initialisieren und Prfsumme setzen
~  !! ~
start !! Startbyte
(!nolink [count]) !! Anzahl der zu bertragenden Bytes
buffer !! Puffer aus bzw. in den geschrieben wird
!end_table

!item [(!nolink [Return]) Value:]
Die Funktion liefert den Wert 0, wenn kein Fehler aufgetreten ist. Ein Wert
von -5 bedeutet, da die Argumente nicht im erlaubten Bereich waren. Ein
Rckgabewert von -12 kennzeichnet eine nicht konsistente Prfsumme.

!item [Group:]
Datum, Uhrzeit und Zeitgeber

!item [Availability:]
Atari TT (TOS 3.xx) and Falcon (TOS 4.xx)

!item [See Also:]
(!link [Binding] [Bindings fr NVMaccess]) ~
(!link [Belegung des NVM][Die Belegung des NVM der Echtzeit-Uhr])

(!ende_liste)


!begin_node Bindings fr NVMaccess
!ignore_index
(!begin_liste) [Assembler:]
!item [C:]
#include <tos.h>

int16_t NVMaccess( int16_t op, int16_t start, int16_t count, int8_t *buffer );
!item [Assembler:]
!begin_verbatim
pea       buffer       ; Offset 8
move.w    count,-(sp)  ; Offset 6
move.w    start,-(sp)  ; Offset 4
move.w    op,-(sp)     ; Offset 2
move.w    #46,-(sp)    ; Offset 0
trap      #14          ; XBIOS aufrufen
lea       $C(sp),sp    ; Stack korrigieren
!end_verbatim
!ifdest [html]
!item [GFA-Basic]
!begin_raw
<A HREF="http://www.milanstation.de/at/gfahutil/gfau7xbi.htm">GFA-H-Util XBios</A>
!end_raw
!endif
(!ende_liste)
!end_node
!end_node


!else


!begin_node NVMaccess
(!begin_liste) [Beschreibung]

!item [Name:]
¯NVMacess® - Konfiguration des "non volatile memory" der Echtzeituhr.

!item [Xbiosnummer:]
46

!item [Binding:]
(!link [Bindings fr NVMaccess] [Bindings fr NVMaccess])

!item [Beschreibung:]
Die XBIOS-Routine NVMaccess erm”glicht die Konfiguration des NVM der
Echtzeituhr. Diese verfgt ber 50 Bytes nicht-flchtiges RAM, wobei die
letzten zwei Bytes als Prfsumme verwendet werden. Es gilt:
!begin_table [l|l]
Parameter !! Bedeutung
!hline
op !! 0 = NVM auslesen und Prfsumme checken
~  !! 1 = NVM beschreiben, Prfsumme checken
~  !! ~~~~und neu setzen
~  !! ~
~  !! 2 = NVM initialisieren und Prfsumme setzen
~  !! ~
start !! Startbyte
(!nolink [count]) !! Anzahl der zu bertragenden Bytes
buffer !! Puffer aus bzw. in den geschrieben wird
!end_table

!item [Ergebnis:]
Die Funktion liefert den Wert 0, wenn kein Fehler aufgetreten ist. Ein Wert
von -5 bedeutet, da die Argumente nicht im erlaubten Bereich waren. Ein
Rckgabewert von -12 kennzeichnet eine nicht konsistente Prfsumme.

!item [Gruppe:]
Datum, Uhrzeit und Zeitgeber

!item [Verfgbar:]
Atari TT (TOS 3.xx) und Falcon (TOS 4.xx)

!item [Querverweis]
(!link [Binding] [Bindings fr NVMaccess]) ~
(!link [Belegung des NVM][Die Belegung des NVM der Echtzeit-Uhr])

(!ende_liste)


!begin_node Bindings fr NVMaccess
!ignore_index
(!begin_liste) [Assembler:]
!item [C:]
#include <tos.h>

int16_t NVMaccess( int16_t op, int16_t start, int16_t count, int8_t *buffer );
!item [Assembler:]
!begin_verbatim
pea       buffer       ; Offset 8
move.w    count,-(sp)  ; Offset 6
move.w    start,-(sp)  ; Offset 4
move.w    op,-(sp)     ; Offset 2
move.w    #46,-(sp)    ; Offset 0
trap      #14          ; XBIOS aufrufen
lea       $C(sp),sp    ; Stack korrigieren
!end_verbatim
!ifdest [html]
!item [GFA-Basic]
!begin_raw
<A HREF="http://www.milanstation.de/at/gfahutil/gfau7xbi.htm">GFA-H-Util XBios</A>
!end_raw
!endif
(!ende_liste)
!end_node
!end_node


!endif
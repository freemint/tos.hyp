<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- last modified on 02.08.2025 -->
<html lang="de">
<head>
<title>
Die Anleitung zum TOS: OSHEADER
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO Version 7.12 (1248) for Linux">
</head>
<body style="position: relative;">

<a name="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_HEAD" href="typedefs.html"><img src="udo_up.gif" alt="Typdefinitionen" title="Typdefinitionen" border="0" width="24" height="24">Typdefinitionen</a>
<a name="UDO_nav_lf_HEAD" href="OHEADER.html"><img src="udo_lf.gif" alt="OHEADER" title="OHEADER" border="0" width="24" height="24">OHEADER</a>
<a name="UDO_nav_rg_HEAD" href="PrintDesc.html"><img src="udo_rg.gif" alt="PrintDesc" title="PrintDesc" border="0" width="24" height="24">PrintDesc</a>

<hr>

<h1><a name="OSHEADER">I.14 OSHEADER</a></h1>
<a name="SYSHDR"></a>
<a name="TOS_2C_20Versionsnummer_20von"></a>
<a name="EmuTOS_2C_20Ermitteln_20von"></a>
<pre>typedef struct _osheader
{
    uint16_t    os_entry;       /* BRAnch-Instruktion zum Reset-Handler */
    uint16_t    os_version;     /* <a href="tos_main.html">TOS</a>-Versionsnummer                   */
    void       *reseth;         /* Zeiger auf Reset-Handler             */
    struct _osheader *os_beg;   /* Basisadresse des Betriebssystems     */
    void       *os_end;         /* erstes nicht vom BS benutztes Byte   */
    int32_t     os_rsvl;        /* reserviert                           */
    <a href="GEM_MUPB.html">GEM_MUPB</a>   *os_magic;       /* <a href="gem_about.html">GEM</a>-Memory-Usage-Parameter-Block     */
    int32_t     os_date;        /* <a href="tos_main.html">TOS</a>-Datum (englisch !) im BCD-Format */
    uint16_t    os_conf;        /* verschiedene Konfigurationsbits      */
    uint16_t    os_dosdate;     /* <a href="tos_main.html">TOS</a>-Datum im <a href="gemdos_main.html">GEMDOS</a>-Format           */

    /* Die folgenden Komponenten stehen erst ab <a href="tos_main.html">TOS</a>-Version 1.02
       (Blitter-<a href="tos_main.html">TOS</a>) zur Verfügung */
    int8_t    **p_root;         /* Basisadresse des <a href="gemdos_main.html">GEMDOS</a>-Pools        */
    int8_t    **pkbshift;       /* Zeiger auf <a href="bios_main.html">BIOS</a>-<a href="About_the_BIOS.html#Kbshift">Kbshift</a>-Variable
                                   Für <a href="tos_main.html">TOS</a> 1.00 siehe <a href="About_the_BIOS.html#Kbshift">Kbshift</a>           */
    <a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a>  **p_run;          /* Adresse der Variablen, die einen
                                   Zeiger auf den aktuellen <a href="gemdos_main.html">GEMDOS</a>-
                                   Prozess enthält.                     */
    int8_t     *p_rsv2;         /* reserviert                           */
                                /* Falls EmuTOS vorhanden, dann 'ETOS'  */
} OSHEADER;
</pre>
<p>Die Struktur taucht auch unter dem Namen SYSHDR auf.
</p>
<p><b>Hinweis:</b>
</p>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">os_conf</td>
<td valign="top"> Die Komponente <i>os_conf</i> enthält im untersten Bit das
sogenannte NTSC/PAL-Flag; ist dieses Bit gesetzt, so handelt es sich
um ein PAL-Videosystem. Die restlichen Bits beinhalten eine
Länderkennung, die z.B. dazu dienen kann, die zu benutzende Sprache
zu erkennen. Es gilt die folgende Belegung:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="center" valign="top">Wert</td>
  <td align="left" valign="top">Land</td>
</tr>
<tr>
  <td align="center" valign="top">0 bis 126</td>
  <td align="left" valign="top">siehe bei der Beschreibung des <a href="bios_cookiejar.html#Cookie_2C_20_AKP">_AKP</a>-Cookie</td>
</tr>
<tr>
  <td align="center" valign="top">127</td>
  <td align="left" valign="top">Alle Länder werden unterstützt.</td>
</tr>
</table>
</div>

<br><b>Achtung:</b> Um die zu benutzende Sprache zu ermitteln,
sollte nach Möglichkeit <i>nicht</i> auf den OSHEADER, sondern auf
den <a href="bios_cookiejar.html#Cookie_2C_20_AKP">_AKP</a>-Cookie bzw. auf die Funktion <a href="appl.html#appl_getinfo">appl_getinfo</a> (Opcode 3)
zurückgegriffen werden.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">p_root</td>
<td valign="top"> Bei <a href="tos_main.html">TOS</a> 1.00 befindet sich der Zeiger bei der Adresse 0x56FA
(0x7E0A im spanischem <a href="tos_main.html">TOS</a>).
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">p_run</td>
<td valign="top">
<br>&nbsp;
<pre><a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a> **GetRun (void)
{
  int32_t savessp = <a href="gemdos_system.html#Super">Super</a> (0L);
  OSHEADER *O = *((OSHEADER **)(0x4f2L);
  <a href="gemdos_system.html#Super">Super</a> ((void *) savessp );

  O = O-&gt;os_beg;  /* wegen eines Fehlers in alter AHDI-Version */

  if (O-&gt;os_version &lt; 0x102)
  {
    if ((O-&gt;os_conf &gt;&gt; 1) == 4)      /* PAL-Modus wegshiften */
      return ((<a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a> **)0x873c);  /* Spanisches <a href="tos_main.html">TOS</a> 1.0   */
    else
      return ((<a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a> **)0x602c);
  }
  else
    return O-&gt;p_run;
}
</pre>

</td></tr>
</table>

<p>Querverweis: <a href="About_the_BIOS.html#Kbshift">Kbshift</a> &nbsp; <a href="bios_sysvars.html#UDO__sysbase">_sysbase</a> &nbsp; <a href="bios_sysvars.html">Systemvariablen</a> &nbsp; <a href="the_system_vectors.html">Systemvektoren</a>
</p>
<hr>

<a name="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_FOOT" href="typedefs.html"><img src="udo_up.gif" alt="Typdefinitionen" title="Typdefinitionen" border="0" width="24" height="24">Typdefinitionen</a>
<a name="UDO_nav_lf_FOOT" href="OHEADER.html"><img src="udo_lf.gif" alt="OHEADER" title="OHEADER" border="0" width="24" height="24">OHEADER</a>
<a name="UDO_nav_rg_FOOT" href="PrintDesc.html"><img src="udo_rg.gif" alt="PrintDesc" title="PrintDesc" border="0" width="24" height="24">PrintDesc</a>
</body>
</html>

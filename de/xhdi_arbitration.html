<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- last modified on 02.08.2025 -->
<html lang="de">
<head>
<title>
Die Anleitung zum TOS: Arbitration
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO Version 7.12 (1248) for Linux">
</head>
<body style="position: relative;">

<a name="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_HEAD" href="xhdi.html"><img src="udo_up.gif" alt="XHDI - eXtended HardDisk Interface (Version 1.30)" title="XHDI - eXtended HardDisk Interface (Version 1.30)" border="0" width="24" height="24">XHDI - eXtended HardDisk Interface (Version 1.30)</a>
<a name="UDO_nav_lf_HEAD" href="xhdi_terminology.html"><img src="udo_lf.gif" alt="XHDI-Terminologie" title="XHDI-Terminologie" border="0" width="24" height="24">XHDI-Terminologie</a>
<a name="UDO_nav_rg_HEAD" href="xhdi_partition_types.html"><img src="udo_rg.gif" alt="Empfohlene Partitiontypen" title="Empfohlene Partitiontypen" border="0" width="24" height="24">Empfohlene Partitiontypen</a>

<hr>

<h1><a name="Arbitration">H.3 Arbitration</a></h1>
<p>Für Gerätetreiber, die den SCSI-Bus arbitrierend betreiben
wollen, muß für den Rechner eine eigene Gerätekennung vergeben
werden. Diese sollte natürlich einheitlich und nicht auf der
Festplatte gespeichert sein. Atari hat dafür Byte 16 im NVM des Atari
TT und Falcon reserviert. Die Bitbelegung ist:
</p>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Bit 0..2:</td>
<td valign="top"> Gerätenummer
</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 7:</td>
<td valign="top"> Arbitration an (1) oder aus (0)

</td></tr>
</table>

<p><b>Die Abfrage der Gerätenummer könnte zum Beispiel wie folgt
geschehen:</b>
</p>
<pre>WORD arbitration_id (VOID)
{
   LONG ret = <a href="gemdos_errors.html#EINVFN">EINVFN</a>;
   UBYTE nvmdata = 0;
   <a href="OSHEADER.html">OSHEADER</a> *Sys;
   LONG oldstack = <a href="gemdos_system.html#Super">Super</a>(0L);
   Sys = *<a href="bios_sysvars.html#UDO__sysbase">_sysbase</a>;
   <a href="gemdos_system.html#Super">Super</a>((VOID *)oldstack);

   host_id = -1;   /* no arbitration by default */

   if (Sys-&gt;os_version &gt;= 0x300)
      ret = <a href="xbios_datetime.html#NVMaccess">NVMaccess</a> (0, 16, (WORD) sizeof (nvmdata), &amp;nvmdata);

   if (ret == <a href="gemdos_errors.html#E_OK">E_OK</a> &amp;&amp; (nvmdata &amp; 0x80))
      host_id = nvmdata &amp; 7;

   return host_id;
}
</pre>
<p>Querverweis: <a href="xhdi.html#XHDI">XHDI-Spezifikation</a> &nbsp; SCSI-Spezifikation &nbsp; <a href="gemdos_main.html">GEMDOS</a> &nbsp; <a href="bios_main.html">BIOS</a>
</p>
<hr>

<a name="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_FOOT" href="xhdi.html"><img src="udo_up.gif" alt="XHDI - eXtended HardDisk Interface (Version 1.30)" title="XHDI - eXtended HardDisk Interface (Version 1.30)" border="0" width="24" height="24">XHDI - eXtended HardDisk Interface (Version 1.30)</a>
<a name="UDO_nav_lf_FOOT" href="xhdi_terminology.html"><img src="udo_lf.gif" alt="XHDI-Terminologie" title="XHDI-Terminologie" border="0" width="24" height="24">XHDI-Terminologie</a>
<a name="UDO_nav_rg_FOOT" href="xhdi_partition_types.html"><img src="udo_rg.gif" alt="Empfohlene Partitiontypen" title="Empfohlene Partitiontypen" border="0" width="24" height="24">Empfohlene Partitiontypen</a>
</body>
</html>

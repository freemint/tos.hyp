<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- last modified on 02.08.2025 -->
<html lang="de">
<head>
<title>
Die Anleitung zum TOS: Schnittstellenprogrammierung
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO Version 7.12 (1248) for Linux">
</head>
<body style="position: relative;">

<a name="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_HEAD" href="xbios_main.html"><img src="udo_up.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24">XBIOS</a>
<a name="UDO_nav_lf_HEAD" href="PCI_BIOS.html"><img src="udo_lf.gif" alt="PCI-BIOS" title="PCI-BIOS" border="0" width="24" height="24">PCI-BIOS</a>
<a name="UDO_nav_rg_HEAD" href="xbios_sound.html"><img src="udo_rg.gif" alt="Soundroutinen" title="Soundroutinen" border="0" width="24" height="24">Soundroutinen</a>

<hr>

<h1><a name="Schnittstellenprogrammierung">4.18 Schnittstellenprogrammierung</a></h1>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Bconmap">Bconmap</a></td>
<td valign="top"> Auswählen einer seriellen Schnittstelle.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Dosound">Dosound</a></td>
<td valign="top"> Soundgenerator programmieren.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#ExtRsConf">ExtRsConf</a></td>
<td valign="top"> Konfiguration der RS232/RS485-Schnittstelle
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Giaccess">Giaccess</a></td>
<td valign="top"> Register des GI-Soundchips lesen und schreiben.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Ikbdws">Ikbdws</a></td>
<td valign="top"> Programmierung des Tastatur-Chips.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Iorec">Iorec</a></td>
<td valign="top"> Interruptpuffer für RS232, Tastatur-Chip und
MIDI-Schnittstelle abfragen.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Kbdvbase">Kbdvbase</a></td>
<td valign="top"> Puffer und Interruptvektoren für Maus-, MIDI- und
Tastaturschnittstelle abfragen.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Mfpint">Mfpint</a></td>
<td valign="top"> Programmierung des Multifunktionsperipherie-Chips.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Midiws">Midiws</a></td>
<td valign="top"> Strings lesen und schreiben auf MIDI-Schnittstelle.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Offgibit">Offgibit</a></td>
<td valign="top"> Bit im Port A-Register des GI-Chips löschen.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Ongibit">Ongibit</a></td>
<td valign="top"> Bit im Port A-Register des GI-Chips setzen.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&#x2022; <a href="#Rsconf">Rsconf</a></td>
<td valign="top"> Konfiguration der RS232-Schnittstelle.

</td></tr>
</table>

<p>Querverweis: <a href="xbios_interrupt.html">Interruptfunktionen</a>
</p>
<h3><a name="Bconmap">4.18.1 Bconmap</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »Select serial port« - wählt eine Default-Schnittstelle aus.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 44
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> int32_t Bconmap( int16_t devno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Bconmap wählt eine der seriellen
Schnittstellen für die Biosausgabe aus. Darüber hinaus kann ein
Zeiger auf die <a href="xbios_structures.html#BCONMAP">BCONMAP</a>-Struktur abgefragt werden, über die man die
maximale BIOS Gerätenummer abfragen und außerdem neue
Gerätetreiber installieren kann. <i>devno</i> kann die folgenden
Werte annehmen:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="right" valign="top">devno</td>
  <td align="left" valign="top">Bedeutung</td>
</tr>
<tr>
  <td align="right" valign="top">-402</td>
  <td align="left" valign="top">device / RSVF-list remove (HSMODA)</td>
</tr>
<tr>
  <td align="right" valign="top">-401</td>
  <td align="left" valign="top">Eintrag anhängen  (HSMODA)</td>
</tr>
<tr>
  <td align="right" valign="top">-400</td>
  <td align="left" valign="top">ausgewählten Eintrag überschreiben (HSMODA)</td>
</tr>
<tr>
  <td align="right" valign="top">-2</td>
  <td align="left" valign="top">Zeiger auf BCONMAP-Struktur liefern</td>
</tr>
<tr>
  <td align="right" valign="top">-1</td>
  <td align="left" valign="top">nur aktuellen Kanal abfragen</td>
</tr>
<tr>
  <td align="right" valign="top">0</td>
  <td align="left" valign="top">Test, ob Bconmap vorhanden ist</td>
</tr>
<tr>
  <td align="right" valign="top">6</td>
  <td align="left" valign="top">ST-kompatibler RS232-Port (U:\dev\modem1)</td>
</tr>
<tr>
  <td align="right" valign="top">7</td>
  <td align="left" valign="top">SCC Kanal B (U:\dev\modem2)</td>
</tr>
<tr>
  <td align="right" valign="top">8</td>
  <td align="left" valign="top">TTMFP RS232-Port (U:\dev\serial1)</td>
</tr>
<tr>
  <td align="right" valign="top">9</td>
  <td align="left" valign="top">SCC Kanal A (U:\dev\serial2)</td>
</tr>
<tr>
  <td align="right" valign="top">&gt;10</td>
  <td align="left" valign="top">eigene Treiber</td>
</tr>
</table>
</div>

<br>Die Funktion beeinflußt sowohl die BIOS-Vektortabelle in den
<a href="bios_sysvars.html">Systemvariablen</a>, als auch das Verhalten der Funktionen Rsconf und Iorec.
<br>&nbsp;
<br><b>Note:</b> In <a href="tos_main.html">TOS</a> 4.04, und wenn kein TT-MFP vorhanden ist,
wird SCC Kanal A als Device #8 bereitgestellt.
<br>&nbsp;
<br><b>HSMODA</b>
<br>Diese Funktionen sind nur vorhanden falls das Paket HSMODA
installiert ist.
<br>&nbsp;
<br><u>int32_t Bconmap((int16_t)-400, (int16_t)dev_nr,
(int32_t)ptr_to_6_longs)</u>
<br>Die Konstante MAPT_OVE wird als -400 definiert. Diese Funktion
dient dem Überschreiben bereits existierender <a href="xbios_structures.html#MAPTAB">MAPTAB</a>-Einträge.
<i>dev_nr</i> ist eine Gerätenummer ab 6 aufwärts, die in der
MAPTAB bereits existieren muß, andernfalls wird der Fehlercode -15
<a href="bios_errors.html#EUNDEV">EUNDEV</a> zurückgegeben. <i>ptr_to_6_longs</i> zeigt auf eine Struktur,
die einem MAPTAB-Eintrag entspricht. Diese Struktur wird auf den
entsprechenden Platz in der MAPTAB kopiert. Ist das angesprochende
Gerät das aktuell per Bconmap für AUX eingestellte, so werden die
eben eingehängten Routinen auch nach xco* und in die aktuellen <a href="#Rsconf">Rsconf</a>
und <a href="#Iorec">Iorec</a>-Zellen kopiert. Diese Funktion dient nur zum Einhängen
<a href="magic.html">MagiC</a>-freundlicher Routinen. Als Erfolgsmeldung wird die Gerätenummer
zurückgegeben, auf die der Eintrag erfolgte, also <i>dev_nr.</i>
<br>&nbsp;
<br>Um Geräte auf den <a href="bios_main.html">BIOS</a>-Nummern zu installieren, die fest zu
einem Computer gehören, ist immer MAPT_OVE zu benutzen. Für den ST
betrifft das z.B. #6, beim MegaSTE #6 bis #8 und beim TT #6 bis #9.
<br>&nbsp;
<br><u>int32_t Bconmap((int16_t)-401, (int32_t)ptr_to_6_longs)</u>
<br>Die Konstante MAPT_APP wird als -401 definiert. Diese Funktion
dient dem Anfügen eines Kanals an die <a href="xbios_structures.html#MAPTAB">MAPTAB</a> oder dem Beschreiben
eines leeren Kanals. <i>ptr_to_6_longs</i> zeigt auf eine Struktur,
die einem MAPTAB-Eintrag entspricht. Rückmeldung ist entweder die von
dieser Funktion für den Eintrag gewählte Kanalnummer, oder der
Fehlercode -12 <a href="bios_errors.html#EGENRL">EGENRL</a>, falls kein Platz für eine
<a href="xbios_structures.html#MAPTAB">MAPTAB</a>-Vergrößerung ist. Hier kann es nicht vorkommen, das die
Vektoren sofort nach xco* übertragen werden, da ein bisher nicht
vorhandener oder belegter Kanal nicht als AUX eingestellt sein kann.
<br>&nbsp;
<br>MAPT_APP sucht sich den ersten freien Kanal hinter den fest zum
Computer gehörenden <a href="bios_main.html">BIOS</a>-Nummern und kann deshalb nur zum
Installieren zusätzlicher Geräte benutzt werden.
<br>&nbsp;
<br><u>int32_t Bconmap((int16_t)-402, (int16_t)dev_nr,
(int32_t)ptr_to_listentry)</u>
<br>Die Konstante MAPT_DEL wird als -402 definiert. Diese Funktion
dient zum Löschen eines Gerätes aus der <a href="xbios_structures.html#MAPTAB">MAPTAB</a> und zum Aushängen
einer RSVF-Liste aus der RSVF-Verkettung.
<br>&nbsp;
<br><i>dev_nr</i> ist entweder die <a href="bios_main.html">BIOS</a>-Kanalnummer des aus der
MAPTAB zu entfernenden Gerätes oder -1 für Nichtstun. Der
entsprechende MAPTAB-Eintrag wird freigeben indem spezielle
Dummy-Routinenzeiger eingetragen werden, die auf den Assemblerbefehl
RTS zeigen. Der <a href="#Iorec">Iorec</a>-Zeiger-Eintrag wird auf 0 gesetzt. Ist der
gelöschte Kanal auch als <a href="bios_main.html">BIOS</a>-AUX-Device eingestellt gewesen, so wird
<a href="bios_main.html">BIOS</a>-AUX auf Nummer 6 umgestellt, auch wenn gerade Nummer 6 gelöscht
wurde.
<br>&nbsp;
<br>ptr_to_listentry ist entweder der Zeiger auf die auszuhängende
RSVF-Liste oder 0 für Nichtstun. Der Zeiger muß auf den Anfang einer
Liste verweisen, die daraufhin komplett entfernt wird, auch wenn sie
mehr als ein Schnittstellenobjekt und End- oder Verkettungsobjekt
enthält.
<br>&nbsp;
<br>Im Erfolgsfall gibt MAPT_DEL 1 zurück, im Fehlerfall -1.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Bconmap liefert die alte Einstellung. Falls <i>devno</i> gleich
-2 ist liefert die Funktion einen Zeiger auf <a href="xbios_structures.html#BCONMAP">BCONMAP</a> zurück.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Laut Atari sollte man seine <a href="tos_main.html">TOS</a>-Version folgendermaßen auf das
Vorhandensein von Bconmap testen:
<br>&nbsp;
<pre>WORD has_bconmap ( VOID )
{
   return (0L == Bconmap (0));
}
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Bconmap">Binding</a> &nbsp; <a href="About_the_BIOS.html#Bconout">Bconout</a> &nbsp; <a href="About_the_BIOS.html#Bconin">Bconin</a> &nbsp; <a href="About_the_BIOS.html#Bcostat">Bcostat</a> &nbsp; <a href="About_the_BIOS.html#Bconstat">Bconstat</a> &nbsp; <a href="#Iorec">Iorec</a> &nbsp; <a href="#Rsconf">Rsconf</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Bconmap">4.18.1.1 Bindings für Bconmap</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>int32_t <a href="#Bconmap">Bconmap</a>( int16_t devno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    devno,-(sp)  ; Offset 2
move.w    #44,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #4,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Dosound">4.18.2 Dosound</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »Dosound« - programmiert den Sound-Generator.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 32
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> void *Dosound( const int8_t *buf );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Dosound startet einen Prozeß zur Steuerung
des Soundgenerators. Der Puffer <i>buf</i> enthält Befehle für die
Programmierung des Sound-Generators. Die folgenden Befehle werden
unterstützt:
<br>&nbsp;
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Befehl</td>
<td valign="top"> Bedeutung
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">0x0x byte</td>
<td valign="top"> Byte in Register x des Soundchips schreiben
</td></tr>

<tr><td nowrap="nowrap" valign="top">0x80 byte</td>
<td valign="top"> Bytes in temporäres Register laden
</td></tr>

<tr><td nowrap="nowrap" valign="top">0x81 byte1</td>
<td valign="top"> Nummer des Soundregisters, in das der Wert des temporären
<a href="xbios_dhs.html#Registers">Registers</a> übertragen werden soll.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;&nbsp;&nbsp;&nbsp; byte2</td>
<td valign="top"> wird zum temporären Register addiert.
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;&nbsp;&nbsp;&nbsp; byte3</td>
<td valign="top"> Wert des temporären <a href="xbios_dhs.html#Registers">Registers</a>, bei dem die Schleife
abgebrochen wird.
</td></tr>

<tr><td nowrap="nowrap" valign="top">0x82 byte</td>
<td valign="top"> Anzahl der Jiffies (20 ms), die bis zum nächsten Kommando
vergehen sollen. Enhält byte den Wert 0, so wird vollständig
abgebrochen.
</td></tr>

<tr><td nowrap="nowrap" valign="top">...</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">0xff byte</td>
<td valign="top"> &nbsp;

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert den momentan abgespielten Sound-Puffer.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Dosound">Binding</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dosound">4.18.2.1 Bindings für Dosound</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>void <a href="#Dosound">Dosound</a>( const int8_t *buf );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>pea       buf          ; Offset 2
move.w    #32,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #6,sp        ; Stack korrigieren
move.l    d0,a0
</pre>

</td></tr>
</table>

<h3><a name="ExtRsConf">4.18.3 ExtRsConf</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »RS-232/RS485 configuration« - konfiguriert die
RS-232/RS485-Schnittstelle.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 162
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> int32_t Xbios( 162, int16_t command, int16_t device, int32_t
param );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine ExtRsConf konfiguriert die serielle
Schnittstelle
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="left" valign="top">Parameter</td>
  <td align="left" valign="top">Bedeutung</td>
</tr>
<tr>
  <td align="left" valign="top">command</td>
  <td align="left" valign="top">0x0000 - return 0 to check that ExtRsConf</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is present</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">0x0001 - set port driver mode:</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param = 0 -&gt; RS232</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param = 1 -&gt; RS422</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param = 2 -&gt; RS485</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">device</td>
  <td align="left" valign="top"><a href="bios_main.html">BIOS</a> device (6 = MFP serial, ...)</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">param</td>
  <td align="left" valign="top">s.o.</td>
</tr>
</table>
</div>

<br><b>Hinweis:</b> Die Funktion ist für die Hardware des Milans
2.1. Die Version gibt es allerdings nur als Spezialversion und ist
nicht frei verfügbar.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> <a href="gemdos_errors.html#E_OK">E_OK</a> (0) - OK
<br><a href="bios_errors.html#EUNCMD">EUNCMD</a> (-3) - unknown command
<br><a href="bios_errors.html#ERROR">ERROR</a> (-1) - general error
<br><a href="bios_errors.html#EUNDEV">EUNDEV</a> (-15) - unknown device
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Die Funktion ist ab dem MilanTOS mit dem Datum 9.6.2002
vorhanden.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20ExtRsConf">Binding</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20ExtRsConf">4.18.3.1 Bindings für ExtRsConf</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>int32_t Xbios( 162, int16_t command, int16_t device, int32_t
param );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.l    param,-(sp)     ; Offset  6
move.w    device,-(sp)    ; Offset  4
move.w    command,-(sp)   ; Offset  2
move.w    #162,-(sp)      ; Offset  0
trap      #14             ; <a href="xbios_main.html">XBIOS</a> aufrufen
lea       10(sp),sp       ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Giaccess">4.18.4 Giaccess</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »access GI sound chip« - ermöglicht den Zugriff auf die
Register des GI-Sound-Chips.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 28
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> int8_t Giaccess( int16_t data, int16_t regno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Giaccess liest bzw. setzt Register im
GI-Soundchip. Es gilt:
<br>&nbsp;
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top"> Bedeutung
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">data</td>
<td valign="top"> wird beim Schreibzugriff in das durch <i>regno</i> angegebene
Register geschrieben.
</td></tr>

<tr><td nowrap="nowrap" valign="top">regno</td>
<td valign="top"> Nummer des gewünschten <a href="xbios_dhs.html#Registers">Registers</a> (0..15). Beim Schreibzugriff
wird zusätzlich Bit-7 gesetzt.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert als Ergebnis den Inhalt des angegebenen
<a href="xbios_dhs.html#Registers">Registers</a>.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Giaccess">Binding</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Giaccess">4.18.4.1 Bindings für Giaccess</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>int8_t <a href="#Giaccess">Giaccess</a>( int16_t data, int16_t regno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    regno,-(sp)  ; Offset 4
move.w    data,-(sp)   ; Offset 2
move.w    #28,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #6,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Ikbdws">4.18.5 Ikbdws</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »write string to keyboard« - programmiert den Tastatur-Chip.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 25
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> void Ikbdws( int16_t count, const int8_t *ptr );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Ikbdws übergibt einen String an die
intelligente Tastatur. Es gilt:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="left" valign="top">Parameter</td>
  <td align="left" valign="top">Bedeutung</td>
</tr>
<tr>
  <td align="left" valign="top">count</td>
  <td align="left" valign="top">Anzahl der auszugebenden Bytes - 1</td>
</tr>
<tr>
  <td align="left" valign="top">ptr</td>
  <td align="left" valign="top">Zeiger auf die Bytes im Speicher</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert kein Ergebnis.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Ikbdws">Binding</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Ikbdws">4.18.5.1 Bindings für Ikbdws</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>void <a href="#Ikbdws">Ikbdws</a>( int16_t count, const int8_t *ptr );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>pea       ptr          ; Offset 4
move.w    count,-(sp)  ; Offset 2
move.w    #25,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #8,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Iorec">4.18.6 Iorec</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »input output record« - Adresse des Ein-/Ausgabepuffers
ermitteln.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 14
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> <a href="xbios_structures.html#IOREC">IOREC</a> *Iorec( int16_t dev );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Iorec liefert die Adresse des
Ein-/Ausgabe-Puffers eines seriellen Gerätes. Der Parameter
<i>dev</i> kann folgende Werte annehmen:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="center" valign="top">dev</td>
  <td align="left" valign="top">Bedeutung</td>
</tr>
<tr>
  <td align="center" valign="top">0</td>
  <td align="left" valign="top">RS-232</td>
</tr>
<tr>
  <td align="center" valign="top">1</td>
  <td align="left" valign="top">Tastatur</td>
</tr>
<tr>
  <td align="center" valign="top">2</td>
  <td align="left" valign="top">MIDI-Port</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert als Ergebnis einen Zeiger auf die Struktur
<a href="xbios_structures.html#IOREC">IOREC</a>.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Iorec">Binding</a> &nbsp; <a href="#Bconmap">Bconmap</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Iorec">4.18.6.1 Bindings für Iorec</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br><a href="xbios_structures.html#IOREC">IOREC</a> *<a href="#Iorec">Iorec</a>( int16_t dev );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    dev,-(sp)    ; Offset 2
move.w    #14,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #4,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Kbdvbase">4.18.7 Kbdvbase</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »keyboard vectors« - liefert einen Zeiger auf die
Tastatur-Interruptvektoren.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 34
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> <a href="xbios_structures.html#KBDVBASE">KBDVBASE</a> *Kbdvbase( void );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Kbdvbase liefert einen Zeiger auf eine KBDVBASE
Struktur.
<br>&nbsp;
<br><b>Hinweis:</b> Bevor einer der in der Struktur angegebenen
Vektoren verändert wird, muß sichergestellt sein, daß nicht gerade
ein Paket verschickt wird (Komponente <i>drvstat</i> = 0).
Anschließend sollten alle Interrupts gesperrt, und dann getestet
werden ob wirklich kein Paket mehr unterwegs ist.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert einen Zeiger auf eine <a href="xbios_structures.html#KBDVBASE">KBDVBASE</a> Struktur
zurück.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Kbdvbase">Binding</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Kbdvbase">4.18.7.1 Bindings für Kbdvbase</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br><a href="xbios_structures.html#KBDVBASE">KBDVBASE</a> *<a href="#Kbdvbase">Kbdvbase</a>( void );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    #34,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #2,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Mfpint">4.18.8 Mfpint</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »init MFP interrupt« - Interrupt initialisieren.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 13
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> void Mfpint( int16_t number, int16_t (*vector)() );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Mfpint initialisiert den
Multifunktions-Interrupt für die angeschlossenen Peripherie-Geräte.
Damit können Hardware-Interrupts abgefangen werden. Das Argument
<i>vector</i> gibt die Interrupt-<a href="proto_ssp.html#Service">Service</a>-Routine an. Im Parameter
<i>number</i> wird die Nummer des Interrupt von 0 bis 15 angegeben:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="center" valign="top">number</td>
  <td align="left" valign="top">Beschreibung</td>
</tr>
<tr>
  <td align="center" valign="top">0</td>
  <td align="left" valign="top">I/O-Port Bit 0 Busy par. Schnittstelle</td>
</tr>
<tr>
  <td align="center" valign="top">1</td>
  <td align="left" valign="top">RS-232 DCD</td>
</tr>
<tr>
  <td align="center" valign="top">2</td>
  <td align="left" valign="top">RS-232 CTS</td>
</tr>
<tr>
  <td align="center" valign="top">3</td>
  <td align="left" valign="top">Blitter</td>
</tr>
<tr>
  <td align="center" valign="top">4</td>
  <td align="left" valign="top">Timer D, RS232-232 Baud-Generator</td>
</tr>
<tr>
  <td align="center" valign="top">5</td>
  <td align="left" valign="top">Timer C, 200-Hz System-Uhr</td>
</tr>
<tr>
  <td align="center" valign="top">6</td>
  <td align="left" valign="top">Tastatur und MIDI</td>
</tr>
<tr>
  <td align="center" valign="top">7</td>
  <td align="left" valign="top">FDC und DMA</td>
</tr>
<tr>
  <td align="center" valign="top">8</td>
  <td align="left" valign="top">Timer B Zeilenrücklauf</td>
</tr>
<tr>
  <td align="center" valign="top">9</td>
  <td align="left" valign="top">RS-232 Sendefehler</td>
</tr>
<tr>
  <td align="center" valign="top">10</td>
  <td align="left" valign="top">RS-232 Sendepuffer leer</td>
</tr>
<tr>
  <td align="center" valign="top">11</td>
  <td align="left" valign="top">RS-232 Empfangspuffer voll</td>
</tr>
<tr>
  <td align="center" valign="top">12</td>
  <td align="left" valign="top">RS-232 Puffer voll</td>
</tr>
<tr>
  <td align="center" valign="top">13</td>
  <td align="left" valign="top">Timer A</td>
</tr>
<tr>
  <td align="center" valign="top">14</td>
  <td align="left" valign="top">RS-232 RI</td>
</tr>
<tr>
  <td align="center" valign="top">15</td>
  <td align="left" valign="top">Monochrom-Monitor Detect</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert kein Ergebnis.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Mfpint">Binding</a> &nbsp; <a href="xbios_interrupt.html#Jdisint">Jdisint</a> &nbsp; <a href="xbios_interrupt.html#Jenabint">Jenabint</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Mfpint">4.18.8.1 Bindings für Mfpint</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>void <a href="#Mfpint">Mfpint</a>( int16_t number, int16_t (*vector)() );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>pea       vector       ; Offset 4
move.w    number,-(sp) ; Offset 2
move.w    #13,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #8,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Midiws">4.18.9 Midiws</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »Midi write string« - gibt eine Zeichenfolge über die
Midi-Schnittstelle aus.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 12
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> void Midiws( int16_t cnt, void *ptr );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Midiws gibt einen String über die
Midi-Schnittstelle aus. Es gilt:
<br>&nbsp;
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top"> Bedeutung
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">cnt</td>
<td valign="top"> Anzahl der auszugebenden Bytes - 1
</td></tr>

<tr><td nowrap="nowrap" valign="top">ptr</td>
<td valign="top"> Zeiger auf Bytefolge

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert kein Ergebnis.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Midiws">Binding</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Midiws">4.18.9.1 Bindings für Midiws</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>void <a href="#Midiws">Midiws</a>( int16_t cnt, void *ptr );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>pea       ptr          ; Offset 4
move.w    cnt,-(sp)    ; Offset 2
move.w    #12,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #8,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Offgibit">4.18.10 Offgibit</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »GI bit off« - löscht ein Bit im Register A des Soundchips.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 29
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> void Offgibit( int16_t bitno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Offgibit löscht ein Bit im Register A des
Soundchips GI. <i>bitno</i> gibt den Wert an, mit dem das Register
verUNDet werden soll. Die Bits in diesem Register haben folgende
Bedeutung:
<br>&nbsp;
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Bit</td>
<td valign="top"> Beschreibung
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;0</td>
<td valign="top"> Floppy Sideselect
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;1</td>
<td valign="top"> Drive Select A
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;2</td>
<td valign="top"> Drive Select B
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;3</td>
<td valign="top"> RS-232 RTS
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;4</td>
<td valign="top"> RS-232 DTR
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;5</td>
<td valign="top"> Centronics Strobe
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;6</td>
<td valign="top"> PIN 3 Monitor Buchse
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;7</td>
<td valign="top"> unbenutzt
<br>ab TOS030 des TT jedoch Modem 4 (1) oder LAN (0)

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert kein Ergebnis.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Offgibit">Binding</a> &nbsp; <a href="#Ongibit">Ongibit</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Offgibit">4.18.10.1 Bindings für Offgibit</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>void <a href="#Offgibit">Offgibit</a>( int16_t bitno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    bitno,-(sp)  ; Offset 2
move.w    #29,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #4,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Ongibit">4.18.11 Ongibit</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »GI bit on« - setzt ein Bit im Register A des Soundchips.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 30
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> void Ongibit( int16_t bitno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Ongibit setzt ein Bit im Register A des
Soundchips GI. <i>bitno</i> gibt den Wert an, mit dem das Register
verODERt werden soll. Die Bits in diesem Register haben folgende
Bedeutung:
<br>&nbsp;
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Bit</td>
<td valign="top"> Beschreibung
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;0</td>
<td valign="top"> Floppy Sideselect
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;1</td>
<td valign="top"> Drive Select A
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;2</td>
<td valign="top"> Drive Select B
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;3</td>
<td valign="top"> RS-232 RTS
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;4</td>
<td valign="top"> RS-232 DTR
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;5</td>
<td valign="top"> Centronics Strobe
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;6</td>
<td valign="top"> PIN 3 Monitor Buchse
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;7</td>
<td valign="top"> unbenutzt
<br>ab TOS030 des TT jedoch Modem 4 (1) oder LAN (0)

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert kein Ergebnis.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Ongibit">Binding</a> &nbsp; <a href="#Offgibit">Offgibit</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Ongibit">4.18.11.1 Bindings für Ongibit</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>void <a href="#Ongibit">Ongibit</a>( int16_t bitno );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    bitno,-(sp)  ; Offset 2
move.w    #30,-(sp)    ; Offset 0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
addq.l    #4,sp        ; Stack korrigieren
</pre>

</td></tr>
</table>

<h3><a name="Rsconf">4.18.12 Rsconf</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »RS-232 configuration« - konfiguriert die
RS-232-Schnittstelle.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top"> 15
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"> int32_t Rsconf( int16_t baud, int16_t ctr, int16_t ucr, int16_t
rsr, int16_t tsr, int16_t scr );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top"> Die <a href="xbios_main.html">XBIOS</a>-Routine Rsconf konfiguriert die serielle
Schnittstelle. Da auf unterschiedlichen Rechnern unterschiedliche
Hardwarebausteine zum Einsatz kommen können, muß die Funktion
vorsichtig eingesetzt werden, d.h:
<br>&nbsp;
<ul>
<li> aktuelle Einstellungen sollten mit Hilfe von Rsconf
(-1,-1,-1,-1,-1,-1) abgefragt werden
</li>
<li> nur die notwendigen Bits manipulieren
</li>
<li> anschließend die neuen Werte setzen
</li>
</ul>

<br>Aufgrund der Möglichkeit unterschiedliche Bausteine zum Einsatz
kommen zu lassen, wurden die benutzbaren Werte folgendermaßen
eingeschränkt:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="left" valign="top">Parameter</td>
  <td align="left" valign="top">Einschränkung</td>
</tr>
<tr>
  <td align="left" valign="top">ucr</td>
  <td align="left" valign="top">Bit 1: <b>Art der Parität</b></td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 = ungerade</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 = gerade</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;2: <b>Parität</b></td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 = nein</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 = ja</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;3+4: <b>Anzahl der Stopbits</b></td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 = ungültig</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 = 1 Stopbit</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 = 1,5 Stopbits</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 = 2 Stopbits</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;5+6: <b>Wortlänge</b></td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 = 8 Bits</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 = 7 Bits</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 = 6 Bits</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 = 5 Bits</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">rsr</td>
  <td align="left" valign="top">nicht anwendbar</td>
</tr>
<tr>
  <td align="left" valign="top">tsr</td>
  <td align="left" valign="top">Bit-3: (1 = Break)</td>
</tr>
<tr>
  <td align="left" valign="top">scr</td>
  <td align="left" valign="top">nicht anwendbar</td>
</tr>
</table>
</div>

<br>Technisch nicht möglich Werte müssen daher ignoriert werden.
Ansonsten gilt folgende Belegung:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="left" valign="top">Parameter</td>
  <td align="left" valign="top">Bedeutung</td>
</tr>
<tr>
  <td align="left" valign="top">baud</td>
  <td align="left" valign="top"><b>Baudrate</b></td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">-1: nicht verändern</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;0: 19200 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;1:  9600 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;2:  4800 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;3:  3600 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;4:  2400 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;5:  2000 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;6:  1800 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;7:  1200 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;8:   600 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;9:   300 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">10:   200 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">11:   150 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">12:   134 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">13:   110 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">14:    75 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">15:    50 Baud</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">ctr</td>
  <td align="left" valign="top"><b>Art der Flußkontrolle</b></td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">-1: nicht verändern</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;0: keine Flußkontrolle</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;1: XON/XOFF (Control-S, Control-Q)</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;2: RTS/CTS</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;3: RTS/CTS und XON/XOFF</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">ucr</td>
  <td align="left" valign="top">neuer Wert für Register, oder -1</td>
</tr>
<tr>
  <td align="left" valign="top">tsr</td>
  <td align="left" valign="top">neuer Wert für Register, oder -1</td>
</tr>
<tr>
  <td align="left" valign="top">rsr</td>
  <td align="left" valign="top">neuer Wert für Register, oder -1</td>
</tr>
<tr>
  <td align="left" valign="top">scr</td>
  <td align="left" valign="top">neuer Wert für Register, oder -1</td>
</tr>
</table>
</div>

<br><b>Hinweis:</b> Ab <a href="tos_main.html">TOS</a> 1.04 kann die zuletzt eingestellte
Baudrate per Rsconf (-2,-1,-1,-1,-1) abgefragt werden. Man sollte sich
niemals darauf verlassen, daß alle Einstellungen tatsächlich wie
gewünscht vorgenommen werden konnten, und deshalb den Rückgabewert
der Funktion beachten.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"> Die Funktion liefert in gepackter Form die Werte der Register
<i>ucr,</i> <i>rsr,</i> <i>scr,</i> <i>tsr</i> und zwar wie folgt:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="left" valign="top">Bits</td>
  <td align="left" valign="top">0..7:</td>
  <td align="left" valign="top">scr-Register</td>
</tr>
<tr>
  <td align="left" valign="top">Bits</td>
  <td align="left" valign="top">8..15:</td>
  <td align="left" valign="top">tsr-Register</td>
</tr>
<tr>
  <td align="left" valign="top">Bits</td>
  <td align="left" valign="top">16..23:</td>
  <td align="left" valign="top">rsr-Register</td>
</tr>
<tr>
  <td align="left" valign="top">Bits</td>
  <td align="left" valign="top">24..31:</td>
  <td align="left" valign="top">ucr-Register</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top"> Alle TOS Versionen.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"> <a href="#Schnittstellenprogrammierung">Schnittstellenprogrammierung</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Rsconf">Binding</a> &nbsp; <a href="#Bconmap">Bconmap</a>
<br>&nbsp;

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Rsconf">4.18.12.1 Bindings für Rsconf</a></h4>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top"> #include &lt;tos.h&gt;
<br>&nbsp;
<br>int32_t <a href="#Rsconf">Rsconf</a>( int16_t baud, int16_t ctr, int16_t ucr, int16_t
rsr, int16_t tsr, int16_t scr );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>move.w    scr,-(sp)    ; Offset 12
move.w    tsr,-(sp)    ; Offset 10
move.w    rsr,-(sp)    ; Offset  8
move.w    ucr,-(sp)    ; Offset  6
move.w    ctr,-(sp)    ; Offset  4
move.w    baud,-(sp)   ; Offset  2
move.w    #15,-(sp)    ; Offset  0
trap      #14          ; <a href="xbios_main.html">XBIOS</a> aufrufen
lea       $E(sp),sp    ; Stack korrigieren
</pre>

</td></tr>
</table>

<hr>

<a name="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_FOOT" href="xbios_main.html"><img src="udo_up.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24">XBIOS</a>
<a name="UDO_nav_lf_FOOT" href="PCI_BIOS.html"><img src="udo_lf.gif" alt="PCI-BIOS" title="PCI-BIOS" border="0" width="24" height="24">PCI-BIOS</a>
<a name="UDO_nav_rg_FOOT" href="xbios_sound.html"><img src="udo_rg.gif" alt="Soundroutinen" title="Soundroutinen" border="0" width="24" height="24">Soundroutinen</a>
</body>
</html>

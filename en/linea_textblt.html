<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- last modified on 2025/08/02 -->
<html lang="en">
<head>
<title>
The documentation for TOS: Text block transfer
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO Version 7.12 (1248) for Linux">
</head>
<body style="position: relative;">

<a name="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_HEAD" href="linea_main.html"><img src="udo_up.gif" alt="Line-A" title="Line-A" border="0" width="24" height="24">Line-A</a>
<a name="UDO_nav_lf_HEAD" href="linea_bitblt.html"><img src="udo_lf.gif" alt="Bit block transfer" title="Bit block transfer" border="0" width="24" height="24">Bit block transfer</a>
<a name="UDO_nav_rg_HEAD" href="linea_showmouse.html"><img src="udo_rg.gif" alt="Show mouse" title="Show mouse" border="0" width="24" height="24">Show mouse</a>

<hr>

<h1><a name="Text_20block_20transfer">6.13 Text block transfer</a></h1>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top"> »Text block transfer«
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Line-A number:</td>
<td valign="top"> $A008
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top"> <a href="#Bindings_20for_20text_blt">Bindings für text_blt</a>
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top"> This Line-A function outputs a single character. The source for
the character must have the same buildup as in a GDOS raster font. One
can can regard the font data as a large image, whose height
corresponds to the character height. All characters lie close to each
other in this &quot;image&quot;. Additionally a GDOS font contains an
offset table, containing the offset for each character in this large
image. The parameter ade_lo of the font header contains the first
ASCII character for which an image and thus also an offset is present.
This offset is to be passed together with the font data to this Line-A
function. The Y-offset is usually 0. As Line-A does not manage the
fonts itself and also does not know the font header, corresponding
parameters for the font data have to be passed. To this must be added
a string of other parameters for various effects such as italic...,
for instance. The following Line-A variables are used:
<br>&nbsp;
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Variable</td>
<td valign="top"> Meaning
</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top"> &nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">wrt_mode</td>
<td valign="top"> Writing mode, the following are possible:
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">REPLACE 0</td>
<td valign="top"> Replace
</td></tr>

<tr><td nowrap="nowrap" valign="top">TRANS 1</td>
<td valign="top"> Transparent (OR)
</td></tr>

<tr><td nowrap="nowrap" valign="top">XOR 2</td>
<td valign="top"> Inverse (XOR)
</td></tr>

<tr><td nowrap="nowrap" valign="top">INVERS 3</td>
<td valign="top"> Inverse Transparent (XOR with not(LN_MASK))

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">xacc_dda</td>
<td valign="top"> Should be set at each call to $8000
</td></tr>

<tr><td nowrap="nowrap" valign="top">dda_inc</td>
<td valign="top"> Scaling factor
</td></tr>

<tr><td nowrap="nowrap" valign="top">t_sclsts</td>
<td valign="top"> Scaling direction, i.e. whether one is enlarging or reducing
</td></tr>

<tr><td nowrap="nowrap" valign="top">mono_status</td>
<td valign="top"> 1 if all characters have the same width, i.e. we are dealing
with a non-proprtional font, else 0
</td></tr>

<tr><td nowrap="nowrap" valign="top">sourcex</td>
<td valign="top"> X-coordinate of the character in font to be output; can be
obtained from the offset table
</td></tr>

<tr><td nowrap="nowrap" valign="top">sourcey</td>
<td valign="top"> Y-coordinate of the character in the font, normally 0
</td></tr>

<tr><td nowrap="nowrap" valign="top">destx</td>
<td valign="top"> X-coordinate of the screen position at which the character is
to be output
</td></tr>

<tr><td nowrap="nowrap" valign="top">desty</td>
<td valign="top"> Y-coordinate of the screen position at which the character is
to be output
</td></tr>

<tr><td nowrap="nowrap" valign="top">delx</td>
<td valign="top"> Width of the character, can also be obtained from the font
header
</td></tr>

<tr><td nowrap="nowrap" valign="top">dely</td>
<td valign="top"> Height of the character, can also be obtained from the font
header
</td></tr>

<tr><td nowrap="nowrap" valign="top">fbase</td>
<td valign="top"> The pointer to the font data, i.e. the image of the glyph
</td></tr>

<tr><td nowrap="nowrap" valign="top">fwidth</td>
<td valign="top"> Width of the font image
</td></tr>

<tr><td nowrap="nowrap" valign="top">style</td>
<td valign="top"> Specifies the text effects; individual bits represent
individual effects and may be combined:
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Bit 0</td>
<td valign="top"> Bold
</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 1</td>
<td valign="top"> Light
</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 2</td>
<td valign="top"> Skewed (&quot;italics&quot;)
</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 3</td>
<td valign="top"> Underlined (is ignored)
</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 4</td>
<td valign="top"> Outlined

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">litemask</td>
<td valign="top"> A mask for light
</td></tr>

<tr><td nowrap="nowrap" valign="top">skewmask</td>
<td valign="top"> A mask for skewed
</td></tr>

<tr><td nowrap="nowrap" valign="top">weight</td>
<td valign="top"> The width for bold
</td></tr>

<tr><td nowrap="nowrap" valign="top">r_off</td>
<td valign="top"> The right offset for skewed, so more or less a parameter for
the &quot;slope&quot; of the character
</td></tr>

<tr><td nowrap="nowrap" valign="top">l_off</td>
<td valign="top"> The left offset for skewed, so more or less a parameter for the
&quot;slope&quot; of the character
</td></tr>

<tr><td nowrap="nowrap" valign="top">scale</td>
<td valign="top"> 1, if scaling is desired
</td></tr>

<tr><td nowrap="nowrap" valign="top">chup</td>
<td valign="top"> <a href="proto_xfsl.html#Rotation">Rotation</a> angle in 1/10 degree; however, only rotation of
multiples of 90 degrees are possible, i.e. values 0, 900, 1800, 2700
</td></tr>

<tr><td nowrap="nowrap" valign="top">text_fg</td>
<td valign="top"> Text colour
</td></tr>

<tr><td nowrap="nowrap" valign="top">text_bg</td>
<td valign="top"> Background colour
</td></tr>

<tr><td nowrap="nowrap" valign="top">scrtchp</td>
<td valign="top"> A buffer that should offer twice as much space as occupied by
the character, so that Line-A can calculate the text effects
</td></tr>

<tr><td nowrap="nowrap" valign="top">scrpt2</td>
<td valign="top"> An index into the buffer that points to the centre of the
buffer, i.e. specifies half of the bufer size
</td></tr>

<tr><td nowrap="nowrap" valign="top">clip</td>
<td valign="top"> 1 if <a href="VDI_fundamentals.html#Clipping">clipping</a> is desired, else 0
</td></tr>

<tr><td nowrap="nowrap" valign="top">xmn_clip</td>
<td valign="top"> X-coordinate of the top left corner of the <a href="VDI_fundamentals.html#Clipping">clipping</a> region, if
clipping is switched on
</td></tr>

<tr><td nowrap="nowrap" valign="top">ymn_clip</td>
<td valign="top"> Y-coordinate of the top left corner of the <a href="VDI_fundamentals.html#Clipping">clipping</a> region, if
clipping is switched on
</td></tr>

<tr><td nowrap="nowrap" valign="top">xmx_clip</td>
<td valign="top"> X-coordinate of the bottom right corner of the <a href="VDI_fundamentals.html#Clipping">clipping</a> region,
if clipping is switched on
</td></tr>

<tr><td nowrap="nowrap" valign="top">ymx_clip</td>
<td valign="top"> Y-coordinate of the bottom right corner of the <a href="VDI_fundamentals.html#Clipping">clipping</a> region,
if clipping is switched on

</td></tr>
</table>

<br>The binding from TC passes a pointer to the font header, flags
for scaling, style, rotation vector, foreground and background colour
not to the text_blt function, but uses the separate function
set_text_blt for setting the parameters in the Line-A parameter block.
Data about the font are set automatically.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The function does not return a result.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top"> All TOS versions.
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"> <a href="#Bindings_20for_20text_blt">Binding</a> &nbsp; <a href="linea_bitblt.html">Bit block transfer</a>
<br>&nbsp;

</td></tr>
</table>

<h3><a name="Bindings_20for_20text_blt">6.13.1 Bindings for text_blt</a></h3>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Pure-C:</td>
<td valign="top"> void text_blt( int16_t x, int16_t y, uint8_t c );
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top">
<br>&nbsp;
<pre>; Save registers
movem.l   D0-D2/A0-A2,-(A7)
; Pointer parameter block <a href="linea_vars.html">LINEA</a>
move.l    pParamblk,A0
; Writing mode in <a href="linea_vars.html">LINEA</a>.wrt_mode
move.w    wmode,(36,A0)
; <a href="proto_olga.html#Clip">Clip</a> mode in <a href="linea_vars.html">LINEA</a>.clip
move.w    mode,(54,A0)
; Top left clip corner, X-coordinate in <a href="linea_vars.html">LINEA</a>.xmn_clip
move.w    cx1,(56,A0)
; Top left clip corner, Y-coordinate in <a href="linea_vars.html">LINEA</a>.ymn_clip
move.w    cy1,(58,A0)
; Bottom right clip corner, X-coordinate in <a href="linea_vars.html">LINEA</a>.xmx_clip
move.w    cx2,(60,A0)
; Bottom right clip corner, Y-coordinate in <a href="linea_vars.html">LINEA</a>.ymx_clip
move.w    cy2,(62,A0)
; Put $8000 in xacc_dda
move.w    #$8000,(64,A0)
; Scaling factor in <a href="linea_vars.html">LINEA</a>.dda_inc
move.w    dda_inc,(66,A0)
; Scaling direction in <a href="linea_vars.html">LINEA</a>.t_sclsts
move.w    t_sclsts,(68,A0)
; Proportional font in <a href="linea_vars.html">LINEA</a>.mono_status
move.w    mono_status,(70,A0)
; X-coordinate in font in <a href="linea_vars.html">LINEA</a>.sourcex
move.w    sourcex,(72,A0)
; Y-coordinate in font in <a href="linea_vars.html">LINEA</a>.sourcey
move.w    sourcey,(74,A0)
; X-destination coordinate <a href="linea_vars.html">LINEA</a>.destx
move.w    destx,(76,A0)
; Y-destination coordinate in <a href="linea_vars.html">LINEA</a>.desty
move.w    desty,(78,A0)
; Width of the character in <a href="linea_vars.html">LINEA</a>.delx
move.w    delx,(80,A0)
; Height of the character <a href="linea_vars.html">LINEA</a>.dely
move.w    dely,(82,A0)
; Start of font data in <a href="linea_vars.html">LINEA</a>.fbase
move.l    fbase,(84,A0)
; Width of the font image in <a href="linea_vars.html">LINEA</a>.fwidth
move.w    fwidth,(88,A0)
; Write style in <a href="linea_vars.html">LINEA</a>.style
move.w    style,(90,A0)
; Mask for light in <a href="linea_vars.html">LINEA</a>.litemask
move.w    litemask,(92,A0)
; Mask for skewed in <a href="linea_vars.html">LINEA</a>.skewmask
move.w    skewmask,(94,A0)
; Width for bold in <a href="linea_vars.html">LINEA</a>.weight
move.w    weight,(96,A0)
; Skewed offset right in <a href="linea_vars.html">LINEA</a>.r_off
move.w    r_off,(98,A0)
; Skewed offset left in <a href="linea_vars.html">LINEA</a>.l_off
move.w    l_off,(100,A0)
; VScaling yes/no in <a href="linea_vars.html">LINEA</a>.scale
move.w    scale,(102,A0)
; <a href="proto_xfsl.html#Rotation">Rotation</a> angle in <a href="linea_vars.html">LINEA</a>.chup
move.w    chup,(104,A0)
; Text color <a href="linea_vars.html">LINEA</a>.text_fg
move.w    text_fg,(106,A0)
; Buffer in <a href="linea_vars.html">LINEA</a>.scrtchp
move.l    scrtchp,(108,A0)
; <a href="indexudo.html">Index</a> to mid-buffer in <a href="linea_vars.html">LINEA</a>.scrpt2
move.w    scrpt2,(112,A0)
; Background color in <a href="linea_vars.html">LINEA</a>.text_bg
move.w    text_bg,(114,A0)
; <a href="linea_main.html">Line-A</a> opcode
dc.w      $A008
; Restore registers
movem.l   (A7)+,D0-D2/A0-A2
</pre>

</td></tr>
</table>

<hr>

<a name="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_FOOT" href="linea_main.html"><img src="udo_up.gif" alt="Line-A" title="Line-A" border="0" width="24" height="24">Line-A</a>
<a name="UDO_nav_lf_FOOT" href="linea_bitblt.html"><img src="udo_lf.gif" alt="Bit block transfer" title="Bit block transfer" border="0" width="24" height="24">Bit block transfer</a>
<a name="UDO_nav_rg_FOOT" href="linea_showmouse.html"><img src="udo_rg.gif" alt="Show mouse" title="Show mouse" border="0" width="24" height="24">Show mouse</a>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- last modified on 2025/12/20 -->
<html lang="en">
<head>
<title>
The documentation for TOS: Arbitration
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO Version 7.12 (1248) for Linux">
</head>
<body style="position: relative;">

<a name="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_HEAD" href="xhdi.html"><img src="udo_up.gif" alt="XHDI - eXtended HardDisk Interface (Version 1.30)" title="XHDI - eXtended HardDisk Interface (Version 1.30)" border="0" width="24" height="24">XHDI - eXtended HardDisk Interface (Version 1.30)</a>
<a name="UDO_nav_lf_HEAD" href="xhdi_terminology.html"><img src="udo_lf.gif" alt="XHDI terminology" title="XHDI terminology" border="0" width="24" height="24">XHDI terminology</a>
<a name="UDO_nav_rg_HEAD" href="xhdi_partition_types.html"><img src="udo_rg.gif" alt="Recommended partition types" title="Recommended partition types" border="0" width="24" height="24">Recommended partition types</a>

<hr>

<h1><a name="Arbitration">H.3 Arbitration</a></h1>
<p>For device drivers which support SCSI arbitration, the machine
needs an own SCSI device number which must be unique and shouldn't be
stored on disk. Atari has reserved byte 16 in the non-volatile memory
(NVRAM) of the Atari TT030 and Falcon030 computers. Bit assignments:
</p>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">Bit 0..2:</td>
<td valign="top"> Device number
</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 7:</td>
<td valign="top"> Arbitration on (1) or off (0)

</td></tr>
</table>

<p><b>The current arbitration number could be inquired this
way:</b>
</p>
<pre>WORD arbitration_id (VOID)
{
   LONG ret = <a href="gemdos_errors.html#EINVFN">EINVFN</a>;
   UBYTE nvmdata = 0;
   <a href="OSHEADER.html">OSHEADER</a> *Sys;
   LONG oldstack = <a href="gemdos_system.html#Super">Super</a>(0L);
   Sys = *<a href="bios_sysvars.html#UDO__sysbase">_sysbase</a>;
   <a href="gemdos_system.html#Super">Super</a>((VOID *)oldstack);

   host_id = -1;   /* no arbitration by default */

   if (Sys-&gt;os_version &gt;= 0x300)
      ret = <a href="xbios_datetime.html#NVMaccess">NVMaccess</a> (0, 16, (WORD) sizeof (nvmdata), &amp;nvmdata);

   if (ret == <a href="gemdos_errors.html#E_OK">E_OK</a> &amp;&amp; (nvmdata &amp; 0x80))
      host_id = nvmdata &amp; 7;

   return host_id;
}
</pre>
<p>See also: <a href="xhdi.html#XHDI">XHDI specification</a> &nbsp; SCSI specification &nbsp; <a href="gemdos_about.html">About the GEMDOS</a> &nbsp; About
the <a href="bios_main.html">BIOS</a>
</p>
<hr>

<a name="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_FOOT" href="xhdi.html"><img src="udo_up.gif" alt="XHDI - eXtended HardDisk Interface (Version 1.30)" title="XHDI - eXtended HardDisk Interface (Version 1.30)" border="0" width="24" height="24">XHDI - eXtended HardDisk Interface (Version 1.30)</a>
<a name="UDO_nav_lf_FOOT" href="xhdi_terminology.html"><img src="udo_lf.gif" alt="XHDI terminology" title="XHDI terminology" border="0" width="24" height="24">XHDI terminology</a>
<a name="UDO_nav_rg_FOOT" href="xhdi_partition_types.html"><img src="udo_rg.gif" alt="Recommended partition types" title="Recommended partition types" border="0" width="24" height="24">Recommended partition types</a>
</body>
</html>

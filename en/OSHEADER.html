<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- last modified on 2025/08/02 -->
<html lang="en">
<head>
<title>
The documentation for TOS: OSHEADER
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO Version 7.12 (1248) for Linux">
</head>
<body style="position: relative;">

<a name="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_HEAD" href="typedefs.html"><img src="udo_up.gif" alt="Type definitions" title="Type definitions" border="0" width="24" height="24">Type definitions</a>
<a name="UDO_nav_lf_HEAD" href="OHEADER.html"><img src="udo_lf.gif" alt="OHEADER" title="OHEADER" border="0" width="24" height="24">OHEADER</a>
<a name="UDO_nav_rg_HEAD" href="PrintDesc.html"><img src="udo_rg.gif" alt="PrintDesc" title="PrintDesc" border="0" width="24" height="24">PrintDesc</a>

<hr>

<h1><a name="OSHEADER">I.14 OSHEADER</a></h1>
<a name="SYSHDR"></a>
<a name="TOS_2C_20Version_20number_20of"></a>
<a name="EmuTOS_2C_20Detect"></a>
<pre>typedef struct _osheader
{
    uint16_t    os_entry;       /* BRAnch instruction to Reset-handler  */
    uint16_t    os_version;     /* <a href="tos_main.html">TOS</a> version number                   */
    void       *reseth;         /* Pointer to Reset-handler             */
    struct _osheader *os_beg;   /* Base address of the operating system */
    void       *os_end;         /* First byte not used by the OS        */
    int32_t     os_rsvl;        /* Reserved                             */
    <a href="GEM_MUPB.html">GEM_MUPB</a>   *os_magic;       /* <a href="gem_about.html">GEM</a> memory-usage parameter block     */
    int32_t     os_date;        /* <a href="tos_main.html">TOS</a> date (English !) in BCD format   */
    uint16_t    os_conf;        /* Various configuration bits           */
    uint16_t    os_dosdate;     /* <a href="tos_main.html">TOS</a> date in <a href="gemdos_main.html">GEMDOS</a> format            */

    /* The following components are available only as of <a href="tos_main.html">TOS</a> Version
       1.02 (Blitter-<a href="tos_main.html">TOS</a>)               */
    int8_t    **p_root;         /* Base address of the <a href="gemdos_main.html">GEMDOS</a> pool      */
    int8_t    **pkbshift;       /* Pointer to <a href="bios_main.html">BIOS</a> <a href="About_the_BIOS.html#Kbshift">Kbshift</a> variable
                                   (for <a href="tos_main.html">TOS</a> 1.00 see <a href="About_the_BIOS.html#Kbshift">Kbshift</a>)           */
    <a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a>  **p_run;          /* Address of the variables containing
                                   a pointer to the current <a href="gemdos_main.html">GEMDOS</a>
                                   process.                             */
    int8_t     *p_rsv2;         /* Reserved                             */
                                /* If EmuTOS is present, then 'ETOS'    */
} OSHEADER;
</pre>
<p>The structure also appears under the name SYSHDR.
</p>
<table class="UDO_env_xlist">
<tr><td nowrap="nowrap" valign="top">os_conf</td>
<td valign="top"> The component <i>os_conf</i> contains the so-called NTSC/PAL
flag in its lowest bit; if this bit is set, then the machine has a PAL
video system, if cleared NTSC. The remaining bits contain a country
identifier, which can serve to denote the language used for menus etc.
for instance. The folowing assignments apply:
<br>&nbsp;
<br><br>
<div align="left"><table border="0" class="UDO_env_table">
<tr>
  <td align="center" valign="top">Value</td>
  <td align="left" valign="top">Country</td>
</tr>
<tr>
  <td align="center" valign="top">0 to 126</td>
  <td align="left" valign="top">see the define by the <a href="bios_cookiejar.html#Cookie_2C_20_AKP">_AKP</a> cookie</td>
</tr>
<tr>
  <td align="center" valign="top">127</td>
  <td align="left" valign="top">All countries are supported.</td>
</tr>
</table>
</div>

<br><b>Warning:</b> To obtain the language in use, one should fall
back <i>not</i> to the OSHEADER if possible, but use the <a href="bios_cookiejar.html#Cookie_2C_20_AKP">_AKP</a>
cookie or the function <a href="appl.html#appl_getinfo">appl_getinfo</a> (opcode 3).
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">p_root</td>
<td valign="top"> With older <a href="tos_main.html">TOS</a> versions the address of <i>p_root</i> is 0x56FA
(0x7E0A in spanish <a href="tos_main.html">TOS</a>).
<br>&nbsp;
</td></tr>

<tr><td nowrap="nowrap" valign="top">p_run</td>
<td valign="top">
<br>&nbsp;
<pre><a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a> **GetRun (void)
{
  int32_t savessp = <a href="gemdos_system.html#Super">Super</a> (0L);
  OSHEADER *O = *((OSHEADER **)(0x4f2L);
  <a href="gemdos_system.html#Super">Super</a> ((void *) savessp );

  O = O-&gt;os_beg;  /* wegen eines Fehlers in alter AHDI-Version */

  if (O-&gt;os_version &lt; 0x102)
  {
    if ((O-&gt;os_conf &gt;&gt; 1) == 4)      /* PAL-Modus wegshiften */
      return ((<a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a> **)0x873c);  /* Spanish <a href="tos_main.html">TOS</a> 1.0   */
    else
      return ((<a href="gemdos_structures.html#BASEPAGE">BASEPAGE</a> **)0x602c);
  }
  else
    return O-&gt;p_run;
}
</pre>

</td></tr>
</table>

<p>See also: <a href="About_the_BIOS.html#Kbshift">Kbshift</a> &nbsp; <a href="bios_sysvars.html#UDO__sysbase">_sysbase</a> &nbsp; <a href="bios_sysvars.html">System variables</a> &nbsp; <a href="the_system_vectors.html">System vectors</a>
</p>
<hr>

<a name="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a>
<a name="UDO_nav_up_FOOT" href="typedefs.html"><img src="udo_up.gif" alt="Type definitions" title="Type definitions" border="0" width="24" height="24">Type definitions</a>
<a name="UDO_nav_lf_FOOT" href="OHEADER.html"><img src="udo_lf.gif" alt="OHEADER" title="OHEADER" border="0" width="24" height="24">OHEADER</a>
<a name="UDO_nav_rg_FOOT" href="PrintDesc.html"><img src="udo_rg.gif" alt="PrintDesc" title="PrintDesc" border="0" width="24" height="24">PrintDesc</a>
</body>
</html>
